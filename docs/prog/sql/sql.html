<!doctype html>
<html>
  <head>
    <title>SQL</title>
    <link rel="stylesheet" href="../../common.css">	
  </head>
  <body>
    <h1>SQL</h1>
	
    <h2>Example (ToDo)</h2>
    <div class="code"><code><pre>	
SELECT * FROM Customers;
SELECT CustomerName, City FROM Customers;
SELECT * FROM Customers WHERE Country='Germany' AND City='Berlin';
SELECT * FROM Customers ORDER BY Country;

INSERT INTO Customers (CustomerName, ContactName) VALUES ('Cardinal', 'Tom B. Erichsen');
UPDATE Customers SET ContactName = 'Alfred Schmidt', City= 'Frankfurt' WHERE CustomerID = 1;
DELETE FROM Customers WHERE CustomerName='Alfreds Futterkiste';
SELECT MIN(Price) AS SmallestPrice FROM Products;
SELECT COUNT(ProductID) FROM Products;
SELECT SUM(Quantity) FROM OrderDetails;
SELECT * FROM Customers WHERE Country IN ('Germany', 'France', 'UK');

The <b>HAVING</b> clause was added to SQL because the <b>WHERE</b> keyword cannot be used with <b>aggregate</b> functions.
SELECT COUNT(CustomerID), Country
FROM Customers
GROUP BY Country
HAVING COUNT(CustomerID) > 5;

SELECT Orders.OrderID, Customers.CustomerName
       FROM Orders <b>INNER JOIN</b> Customers ON Orders.CustomerID=Customers.CustomerID;
	   
<b>Group By</b> arranges similar data into groups and <b>Order By</b> sorts the data in ascending or descending order	   
SELECT COUNT(CustomerID), Country
FROM Customers
GROUP BY Country
ORDER BY COUNT(CustomerID) DESC;

SELECT COUNT(CustomerID), Country FROM Customers GROUP BY Country;

A stored procedure is a prepared SQL code that you can save, so the code can be reused over and over again.
CREATE PROCEDURE SelectAllCustomers AS SELECT * FROM Customers GO;
EXEC SelectAllCustomers;

A <b>trigger</b> is a stored procedure which automatically invokes whenever an event occurs(a row is inserted, or columns are updated)
create trigger stud_marks 
before INSERT 
on 
Student 
for each row 
set Student.total = Student.subj1 + Student.subj2 + Student.subj3, Student.per = Student.total * 60 / 100;


SQL Server / Oracle / MS Access:
CREATE DATABASE testDB;
DROP DATABASE testDB;
CREATE TABLE Persons (
    ID int NOT NULL PRIMARY KEY AUTO_INCREMENT,
    LastName varchar(255)
);
ALTER TABLE Customers ADD Email varchar(255);

<b>PostgreSQL</b>
CREATE TABLE po_headers (
	po_no INTEGER PRIMARY KEY,
	vendor_no INTEGER,
	description TEXT
);

SQL Constraints
NOT NULL - Ensures that a column cannot have a NULL value
UNIQUE - Ensures that all values in a column are different
PRIMARY KEY - A combination of a NOT NULL and UNIQUE. Uniquely identifies each row in a table
FOREIGN KEY - Prevents actions that would destroy links between tables. 
	FOREIGN KEY is a field(s) in one table, that refers to the PRIMARY KEY in another table.
CHECK - Ensures that the values in a column satisfies a specific condition
DEFAULT - Sets a default value for a column if no value is specified
CREATE INDEX - Used to create and retrieve data from the database very quickly

Date:
SELECT * FROM Orders WHERE OrderDate='2008-11-11'


PostgreSQL Data Types
boolean, alias: bool
integer, alias: int
character(n), alias: char [ (n) ]
character varying(n) or text, alias: varchar [ (n) ]

<b>KNORR BREMSE</b>

DROP TABLE if exists projects,issues CASCADE;

CREATE TABLE issues (
	iid         serial PRIMARY KEY,
	pid         integer REFERENCES projects(pid) NOT NULL,
	creator     varchar(255) NOT NULL,
	description text,
	updated     timestamp
);

CREATE TYPE customtype AS ENUM ('timestamp', 'label');

INSERT INTO versions (vid, pid, name) values (DEFAULT,1,'1.0');


Statement statement = connection.createStatement();                               
ResultSet resultSet = statement.executeQuery("SELECT cfid,name,type FROM customfields ORDER BY cfid ASC");    
resultSet.next();
issue.setId(resultSet.getInt(1));

<p><img src="images/join.png"/></p>
<p><img src="https://lh6.googleusercontent.com/I7BWNmU-rtwMozqKzbWBRgnk2sIv1a1FGElwOheS4ybu8o8erqvNR8Z57CsHndxMpdKlUq8jqaDqyUt7pR775-lSupnm_Cqe5nyncxH3eh0MTf3IA2cWz_8rnMWyDXFIrf-z_MM18zMVs_rQuiIigOw"/></p>
</pre></code></div>	
  </body>
</html>
