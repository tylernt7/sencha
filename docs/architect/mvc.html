<!doctype html>
<html>
  <head>
    <title>MVC</title>
    <link rel="stylesheet" href="../common.css">
  </head>
  <body>
    <h1>Model–View–Controller</h1>
	
    <h2>Purpose</h2>	
	<p>MVC is an architectural pattern used to decouple/separate/divide data (model), user-interface (view) and application logic (controller).</p> 
 	<ul>
	  <li><b>Model</b>: data (business logic, persistence, validation, conversion)</li>
	  <ul><li><i>Passive model</i>: controller notifies the view when model changes</li></ul>
	  <ul><li><i>Active model</i>: model notifies the view when model changes (observer pattern)</li></ul>
	  <li><b>View</b>: data presentation (grids, trees, panels)</li>
	  <li><b>Controller</b>: handling user interactions (rendering, routing, instantiating)</li>
	  <ul><li><i>GUI</i>: button clicks, menu selections, scroll-bar dragging</li></ul>
	  <ul><li><i>Web application</i>: GET, POST HTTP requests</li></ul>
	</ul> 
 
    <h2>Difference between MVC (1970), MVP (1990) and MVVM (2005)</h2>
	<p>In the MVC (<b>M</b>odel <b>V</b>iew <b>C</b>ontroller) pattern, the controller gets all user input. Depending on the kind of input, it shows up a different view or modifies the model.</p>
	<p>In the MVP (<b>M</b>odel <b>V</b>iew <b>P</b>resenter) pattern, the view gets the user input and forwards it to the presenter. The presenter then modifies the view or the model depending on the type of user action. The presenter pushes the data into the view.</p>
	<p>In the MVVM (<b>M</b>odel <b>V</b>iew <b>V</b>iew<b>M</b>odel) pattern, the view gets the user input and forwards it to the viewmodel (using commands). The view actively pulls the data from the viewmodel (using data binding).</p>
	<p>Note that the model is not aware of the view or the controller -- it simply broadcasts change notifications (events) to all interested listeners.</p>
	<center><p>
	<img src="images\mvc_mvp_mvvm.png" width="60%" height="60%"/>
	<img src="images\MVC_Explained_in_4_Minutes.png" width="35%" height="35%"/>
	</p></center>
    
	<table border="1">
    <thead>
      <tr>
        <th>MVC</th>
        <th>MVP</th>
        <th>MVVM</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Input is directed at the Controller</td>
        <td>Input is directed at the View</td>
        <td>Input is directed at the View</td>
      </tr>
      <tr>
        <td>Many-to-one relationship between View and Controller</td>
        <td>One-to-one relationship between View and Presenter</td>
        <td>One-to-many relationship between View Model and View</td>
      </tr>
      <tr>
        <td>View does not have any knowledge of the Controller</td>
        <td>View holds a reference to the Presenter, Presenter is aware of the View</td>
        <td>View Model does not have any knowledge of the View</td>
      </tr>
      <tr>
        <td>View is aware of the Model (Controller passes the Model to the View)</td>
        <td>View is not aware of the Model, Presenter updates the View/Model</td>
        <td>View is not aware of the Model, View Model updates the View/Model</td>
      </tr>
      <tr>
        <td>Unit Testability: Difficult</td>
        <td>Unit Testability: Good</td>
        <td>Unit Testability: Great</td>		
      </tr>	  
      <tr>
        <td>Smalltalk, ASP.Net MVC</td>
        <td>Windows forms</td>
        <td>Silverlight, WPF, HTML5 with Knockout/AngularJS</td>
      </tr>	  
    </tbody>
    </table>	
	
	

 	<br>
	<center><table>
      <tr>
        <td><img src="images\mvc_passive.png" width="80%" height="80%"/></td>
        <td><img src="images\mvc_active.png" width="80%" height="80%"/></td>
      </tr>
      <tr>
        <td style="text-align:center">MVC (Passive Model)</td>
        <td style="text-align:center">MVC (Active Model)</td>
      </tr>  
      <tr>
        <td><img src="images\mvp_passive.png" width="80%" height="80%"/></td>
        <td><img src="images\mvp_passive_observer.png" width="80%" height="80%"/></td>	
      </tr> 
      <tr>
        <td style="text-align:center">MVP (Passive View)</td>
        <td style="text-align:center">MVP (Passive View - Observer)</td>	
      </tr>
      <tr>
        <td><img src="images\mvp_supervising.png" width="80%" height="80%"/></td>
        <td><img src="images\mvp_supervising_observer.png" width="80%" height="80%"/></td>	
      </tr> 
      <tr>
        <td style="text-align:center">MVP (Supervising Controller)</td>
        <td style="text-align:center">MVP (Supervising Controller - Observer)</td>	
      </tr>
      <tr>
        <td><img src="images\mvvm.png" width="80%" height="80%"/></td>
        <td><img src="images\mvvm_observer.png" width="80%" height="80%"/></td>	
      </tr> 
      <tr>
        <td style="text-align:center">MVVM</td>
        <td style="text-align:center">MVVM (Observer)</td>	
      </tr>	  	  
	</table></center>
	
 	
	<br>
	<center>
	<p><img src="images\mvvm0.png" width="50%" height="50%"/></p>
	<p>MVVM</p></center>
		
	<h2>Design Patterns in MVC</h2>
    <table border="1">
    <thead>
      <tr>
        <th>Model</th>
        <th>View</th>
        <th>Controller</th>
        <th>Presenter</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td></td>
        <td>Observer</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td>Composite</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td>Strategy</td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td>Factory</td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td>Decorator</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td>Mediator</td>
      </tr>
      <tr>
        <td></td>
        <td>Command</td>
        <td></td>
        <td></td>
      </tr>
    </tbody>
    </table>	
	
    <table>
    <tbody>
      <tr>
        <td>
			<ul>
			  <center><h2>Benefits of MVC</h2></center>
			  <li>High flexibility: different user interfaces for the same model</li>
			  <li>High reusability: use model and view classes in other applications again</li>
			  <li>High maintainability: separation of concerns</li>
			  <li>Easier testing: model is independent of view and controller</li>
			</ul>  		
		</td>
        <td>
			<ul>	
			  <center><h2>Drawbacks of MVC</h2></center>			
			  <li>Complex structure: many patterns</li>	
			  <li>Difficult scalability: model interface changes require view changes</li>
			  <li>Frequent updates: model data changes require many notifications</li>
			</ul>  			
		</td>
      </tr>    
    </tbody>
    </table>
		
	<h2>JavaScript Example</h2>
	<div class="code"><code>	   
<pre><i>/** Simulate Model, View, Controller */</i>
var M = {}, V = {}, C = {};

<i>/** Model is responsible for storing data */</i>
M.data = "Hello World!";

<i>/** View is responsible for outputting data to the user */</i>
V.render = (M) => { alert(M.data); }

<i>/** Controller acts as a bridge connecting M and V */</i>
C.handleOnload = () => { V.render(M); }

<i>/** Call the Controller when the web page loads */</i>
window.onload = C.handleOnload;</pre>
	</code></div>	
	
	<h2>MVC Implementation</h2>
 	<ul>
	  <li>Java 2 Platform, Enterprise Edition (J2EE)</li>
	  <ul><li><b>Model</b>: Entity Bean</li></ul>
	  <ul><li><b>View</b>: Java Server Pages (JSP)</li></ul>
	  <ul><li><b>Controller</b>: Java Servlet (Apache Struts 2, Spring Framework)</li></ul>
	</ul> 	
 	<ul>
	  <li>Java Swing</li>
	  <ul><li><b>Model</b>: ButtonModel, Document, TableModel, TreeModel</li></ul>
	  <ul><li><b>UI delegate (View + Controller)</b>: JButton, JTextField/JTextArea/JTextPane/JEditorPane (JTextComponent), JTable, JTree</li></ul>	  
	</ul> 		
 	<ul>
	  <li>ASP.NET MVC</li>
	  <ul><li><b>Model</b>: Entity Data Model</li></ul>
	  <ul><li><b>View</b>: Razor (.cshtml and .vbhtml) or Web Forms (.aspx)</li></ul>
	  <ul><li><b>Controller</b>: Routing mechanism</li></ul>
	</ul> 		
 	<ul>
	  <li>Windows Forms (WinForms)</li>
	  <ul><li><b>Model</b>: Entity Data Model</li></ul>
	  <ul><li><b>View</b>: Form or Control class</li></ul>
	  <ul><li><b>Controller</b>: Event handlers</li></ul>
	</ul> 
	
	<h2>References</h2>
 	<ul>
	  <li>MVP</li>
	  <ul><li><a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/CocoaDesignPatterns.html">Cocoa Design Pattern (Apple)</a></li></ul>
	  <ul><li><a href="https://web.archive.org/web/20140205220720/http://msdn.microsoft.com:80/en-us/library/ff647543.aspx">Model-View-Presenter Pattern (Microsoft)</a></li></ul>
 	</ul>
 	<ul>
	  <li>MVVM</li>
	  <ul><li><a href="https://learn.microsoft.com/en-us/archive/blogs/johngossman/introduction-to-modelviewviewmodel-pattern-for-building-wpf-apps">Introduction to Model/View/ViewModel pattern for building WPF apps (Microsoft)</a></li></ul>
	  <ul><li><a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2009/february/patterns-wpf-apps-with-the-model-view-viewmodel-design-pattern">Patterns - WPF Apps With The Model-View-ViewModel Design Pattern (Microsoft)</a></li></ul>
 	</ul>
	
	<h2>Sample Applications</h2>
 	<ul>
	  <li>MVC</li>
	  <ul><li><a href="https://www.youtube.com/watch?v=yvgy19C8ytQ">Video: Model View Controller (MVC) - Observer Pattern</a></li></ul>
	  <ul><li><a href="https://www.nerdwest.de/downloads.php?filter=MVC">Code: Model View Controller (MVC)</a></li></ul>
	</ul>
 	<ul>
	  <li>MVP</li>
	  <ul><li><a href="https://www.oracle.com/technical-resources/articles/javase/mvc.html">Article: Java SE Application Design With MVC</a></li></ul>
	  <ul><li><a href="https://github.com/101companies/101repo/tree/master/technologies/Java_platform/samples/sunMvcSample">Code: sunMvcSample</a></li></ul>
	  <ul><li><a href="http://java.sun.com/developer/technicalArticles/javase/mvc/MVCExample.zip">Code: MVCExample (not available)</a></li></ul>
	</ul> 		
 	<ul>
	  <li>MVVM</li>
	  <ul><li><a href="https://www.youtube.com/watch?v=ak9W_D1xFbU">Video: JavaFX and MVVM</a></li></ul>
	  <ul><li><a href="https://github.com/TroelsMortensen/NestedFXML">Code: NestedFXML</a></li></ul>
	  <ul><li><a href="https://github.com/TroelsMortensen/DataVisualizer">Code: DataVisualizer</a></li></ul>
	</ul>
	
	<h2>Unit Test (MVP)</h2>
	<h3>Model</h3>
 	<ul>
	  <li>Verify whether methods behave as expected or properties were set correctly by the model</li>
 	</ul>	 	
	<h3>Presenter</h3>
 	<ul>
	  <li>Create mock classes that implement the interfaces of the model and the view</li>
	  <ul><li>Replace the real objects with mock objects (no dependencies in the testing environment)</li></ul>
	  <li>Provide additional elements in the mock objects</li>
	  <ul><li>Use flags to verify whether methods were invoked or properties were set by the presenter</li></ul>
	  <li>Verify whether methods behave as expected or properties were set correctly by the model</li>
 	</ul>	  
	
	<h2>ToDo</h2>
 	<ul>
	  <li><a href="https://www.codingninjas.com/codestudio/library/difference-between-mvc-mvp-and-mvvm-architecture-in-android">Difference between MVC, MVP, and MVVM Architecture in Android</a></li>
	  <li><a href="https://dotnet.microsoft.com/en-us/apps/aspnet/mvc">ASP.NET MVC Pattern</a></li>	
	  <li><a href="https://www.geeksforgeeks.org/mvp-model-view-presenter-architecture-pattern-in-android-with-example/">MVP (Model View Presenter) Architecture Pattern in Android with Example</a></li>
	  <li><a href="https://grantwinney.com/its-possible-to-test-a-winforms-app-using-mvp/">Using MVP to test a WinForms app</a></li>
	  <li><a href="https://www.youtube.com/watch?v=Lp7nSImO5vk">YouTube: Learn ASP.NET MVC 5 ( Model view controller) step by step in 2 days ( 16 hours)</a></li>
	  <li><a href="https://www.youtube.com/watch?v=g2b-NbR48Jo">YouTube: Spring MVC Tutorial | Full Course</a></li>	   
	</ul>	  
  </body>
</html>