<!doctype html>
<html>
  <head>
    <title>Kubernetes command-line tool (kubectl)</title>
    <link rel="stylesheet" href="../common.css">
  </head>
  <body>
    <h1>Kubernetes command-line tool (kubectl)</h1>

	<h2>Commands</h2>
	<table border="1" style="width: 100%;">
    <tr>
      <td style="width: 50%;"><b>Usage</b></td>
      <td style="width: 50%;"><b>Description</b></td>
    </tr>	
    <tr>
      <td>kubectl get namespace</td>
	  <td>List all the namespaces in the Kubernetes cluster</td>
    </tr>	
    <tr>
      <td>kubectl get pods</td>
	  <td>List all the pods in the current namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get pods -n default</td>
	  <td>List all the pods in the default namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get pods -n &lt;namespace></td>
	  <td>List all the pods in the specified namespace in the Kubernetes cluster</td>
    </tr>	
    <tr>
      <td>kubectl get pods --kubeconfig ~/.kube/config</td>
	  <td>List all the pods in the current namespace in the Kubernetes cluster using the specified kubeconfig file</td>
    </tr>
    <tr>
      <td>kubectl logs -f &lt;pod> > container.log</td>
	  <td>Stream the logs of the pod to a file</td>
    </tr>	
    <tr>
      <td>kubectl get deployments -n &lt;namespace></td>
      <td>List all the deployments in the specified namespace</td>
    </tr>		
    <tr>
      <td>kubectl scale deployment &lt;deployment> -n &lt;namespace> --replicas=&lt;n></td>
      <td>Scale a deployment to have n (e.g. 3) replicas</td>
    </tr>
    <tr>
      <td>kubectl -n &lt;namespace> -it exec &lt;container> -- /bin/sh</td>
      <td>Execute a shell inside a running container in the specified namespace</td>
    </tr>
    <tr>
      <td>kubectl apply -f &lt;filename|url> -n &lt;namespace></td>
      <td>Create or update resources (ConfigMap, Ingress) in the specified namespace in the Kubernetes cluster</td>
    </tr>
	</table>
	<br>	
	<table border="1" style="width: 100%;">
    <tr>
      <td style="width: 50%;"><b>Usage</b></td>
      <td style="width: 50%;"><b>Description</b></td>
    </tr>
    <tr>
      <td>kubectl get configmap(s)</td>
      <td>List the ConfigMaps in the current namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get configmap(s) -n &lt;namespace></td>
      <td>List the ConfigMaps in the specified namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get configmap(s) &lt;configmap-name> -n &lt;namespace> -o yaml<br>
	      kubectl get configmap(s)/&lt;configmap-name> -n &lt;namespace> -o yaml</td>
      <td>Get the specified ConfigMap in the specified namespace in the Kubernetes cluster in YAML format</td>
    </tr>	
    <tr>
      <td>kubectl edit configmap(s) &lt;configmap-name> -n &lt;namespace><br>
	      kubectl edit configmap(s)/&lt;configmap-name> -n &lt;namespace></td>
      <td>Edit the specified ConfigMap in the specified namespace in the Kubernetes cluster</td>
    </tr>
	</table>
	<br>
	<table border="1" style="width: 100%;">
    <tr>
      <td style="width: 50%;"><b>Usage</b></td>
      <td style="width: 50%;"><b>Description</b></td>
    </tr>
    <tr>
      <td>kubectl get ingress(es)</td>
      <td>List the ConfigMaps in the current namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get ingress(es) -n &lt;namespace></td>
      <td>List the ConfigMaps in the specified namespace in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get ingress(es) &lt;ingress-name> -n &lt;namespace> -o yaml<br>
	      kubectl get ingress(es)/&lt;ingress-name> -n &lt;namespace> -o yaml</td>
      <td>Get the specified Ingress in the specified namespace in the Kubernetes cluster in YAML format</td>
    </tr>	
    <tr>
      <td>kubectl edit ingress(es) &lt;ingress-name> -n &lt;namespace><br>
	      kubectl edit ingress(es)/&lt;ingress-name> -n &lt;namespace></td>
      <td>Edit the specified Ingress in the specified namespace in the Kubernetes cluster</td>
    </tr>
	</table>
	<br>
	<table border="1" style="width: 100%;">
    <tr>
      <td style="width: 50%;"><b>Usage</b></td>
      <td style="width: 50%;"><b>Description</b></td>
    </tr>
    <tr>
      <td>kubectl get pvc</td>
      <td>List all the Persistent Volume Claims (PVCs) in the Kubernetes cluster</td>
    </tr>
    <tr>
      <td>kubectl get pvc -n &lt;namespace></td>
      <td>List all the PVCs in the specified namespace in the Kubernetes cluster</td>
    </tr>	
	</table>
	<br>
	<table border="1" style="width: 100%;">
    <tr>
      <td style="width: 50%;"><b>Usage - TODO review below</b></td>
      <td style="width: 50%;"><b>Description</b></td>
    </tr>	
    <tr>
      <td>kubectl run my-pod --image=my-docker-username/my-app-image:1.0</td>
	  <td>Pod létrehozása. POD elindítása a Clusteren</td>
    </tr>	
    <tr>
      <td>kubectl get pods<br>kubectl describe pod &lt;pod-name></td>
	  <td>Futó pod/node és környezetének/állapotának lekérdezése/ellenőrzése. POD futásának ellenőrzése</td>
    </tr>
    <tr>
      <td>kubectl exec my-pod -- /bin/sh -c "kill 1" </td>
	  <td>Az alkalmazás hibájának szimulálása</td>
    </tr>
    <tr>
      <td>kubectl logs my-pod</td>
	  <td>Pod logjainak ellenőrzése</td>
    </tr>
    <tr>
      <td>kubectl delete pod my-pod</td>
	  <td>A tesztelési céllal létrehozott pod törlése a clusterből</td>
    </tr>
    <tr>
      <td>kubectl exec my-pod -- /bin/sh -c "curl localhost:8080"</td>
	  <td>Alkalmazás működésének/állapotának ellenőrzése</td>
    </tr>
    <tr>
      <td>kubectl get nodes</td>
	  <td>Cluster állapotának ellenőrzése. Node-ok állapotának lekérdezése</td>
    </tr>
    <tr>
      <td>kubectl exec my-pod -- /bin/sh -c "while true; do curl localhost:8080; sleep 1; done"</td>
	  <td>Alkalmazás működésének ellenőrzése</td>
    </tr>
    <tr>
      <td>kubectl drain &lt;node-ip> --ignore-daemonsets</td>
	  <td>Valamely node eltávolítása a clusterből</td>
    </tr>
    <tr>
      <td>kubectl get pods -o wide</td>
	  <td>POD állapotának ellenőrzése</td>
    </tr>
    <tr>
      <td>kubectl uncordon &lt;node-ip></td>
	  <td>Node visszaállítása a clusterbe</td>
    </tr>
    <tr>
      <td>kubectl exec -it postgres-0 -- psql -U postgres<br>postgres=# \l</td>
	  <td>Az adatbázis(ok) állapotának ellenőrzése a clusterben</td>
    </tr>
    <tr>
      <td>kubectl exec -it postgres-0 -- /bin/bash<br>pg_ctl promote -D /var/lib/postgresql/data<br>exit</td>
	  <td>Node visszaállítása a clusterbe</td>
    </tr>
    </table>
	
	<h2>Examples</h2>
	Upscaling:<br>
	<code>kubectl scale deployment invoice-api -n iqr-core-dev --replicas=1</code><br>
	Downscaling:<br>
	<code>kubectl scale deployment invoice-api -n iqr-core-dev --replicas=0</code><br>
	(The deployments are APIs, the namespaces are dev, demo, main branches)<br>
	<br>
	<code>kubectl apply -f invoice-api.yml -n iqr-core-dev</code><br>
	<code>kubectl edit ingress invoice-api -n iqr-core-dev</code><br>
	<code>kubectl get ingress -n iqr-core-dev</code>

    <h2>Install Kubernetes</h2>
    <code>choco install kubernetes-cli</code><br>
    <code>choco install kubelogin</code><br>	
	c:\Users\UserName\.kube\config (see <a href="https://github.com/int128/kubelogin">https://github.com/int128/kubelogin</a>)<br>
	<code>rename c:\ProgramData\chocolatey\bin\kubelogin.exe kubectl-oidc_login.exe</code> (needed to follow the kubectl plugin naming convention)</p>

  </body>
</html>


